package kr.or.ddit.refle.servlet;

import java.io.IOException;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import kr.or.ddit.cart.service.CartServiceImpl;
import kr.or.ddit.cart.service.ICartService;
import kr.or.ddit.refle.vo.RefleVO;


@WebServlet("/RefleServlet")
public class RefleServlet extends HttpServlet{
	private static final long serialVersionUID = 1L;
	
	
	@Override
	protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
		// TODO Auto-generated method stub
				doPost(req, resp);
	}
	
	
	
	
	@Override
	protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	
		
		String flag = req.getParameter("flag");
		
			
			if("refle".equals(flag)) { 
				
				String memId =  req.getParameter("memId");
				String prodNum = req.getParameter("prodNum"); 
				String prodRefleTitle = req.getParameter("prodRefleTitle"); 
				String prodRefleContent = req.getParameter("prodRefleContent");
				
				RefleVO refleVo = new RefleVO();
				refleVo.setMemId(memId);
				refleVo.setProdNum(prodNum);
				refleVo.setProdName(prodName);
				refleVo.setProdPrice(prodPrice);
				refleVo.setProdMemberPrice(prodMemberPrice);
				refleVo.setProdImgPath(prodImgPath);
				
				
				
				
				
				String memId2 = cartVo.getMemId();
				String prodNum2 =  cartVo.getProdNum();
				String prodName2 = cartVo.getProdName();
				long prodPrice2 =  cartVo.getProdPrice();
				long prodMemberPrice2 = cartVo.getProdMemberPrice();
				String prodImgPath2 = cartVo.getProdImgPath();
				
				System.out.println("두번째"+memId2+prodNum2+prodName2+prodPrice2+prodMemberPrice2+prodImgPath2);
				
				
				
				
				
				
				ICartService cartService = CartServiceImpl.getInstance();
				
				
				int cnt = cartService.insertCart(cartVo);
				int resultCnt = 0;
				if (cnt > 0) {
					resultCnt = 1;
				}
				req.setAttribute("resultCnt", resultCnt);

				RequestDispatcher disp = req.getRequestDispatcher("/HW_main/common/checkResult.jsp");
				disp.forward(req, resp);
				
				
				
			}else if("SI".equals(flag)) {
				
				
			} else if("GU".equals(flag)) {
				
				
			} else if("DONG".equals(flag)) {
				
				
			}else {
				
				
			}
			
		
		
	}
	
	
	
	
	
	
	
	
	
	
}











































